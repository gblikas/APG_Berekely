function sig = sinkage_sigma(sigma, tk)

[n1, n2] = size(sigma);
sig = zeros(n1, n2);

% sigma(sigma < 0.5) = 0;

n = length(find(sigma > 0));

for i=1:n
    if sigma(i, i) >= tk
        sig(i, i) = sigma(i, i) - tk;
%         sig(i, i) = 1;
        
    elseif sigma(i, i) <= -tk
        sig(i, i) = sigma(i, i) + tk;
    else
        sig(i, i) = 0;
    end
end
